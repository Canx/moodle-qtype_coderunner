'use strict';goog.provide("Blockly.Lua.texts");goog.require("Blockly.Lua");Blockly.Lua.text=function(a){var b=Blockly.Lua.quote_(a.getFieldValue("TEXT"));return[b,Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.text_multiline=function(a){var b=Blockly.Lua.multiline_quote_(a.getFieldValue("TEXT"));return[b,Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.text_join=function(a){if(0==a.itemCount_){return["''",Blockly.Lua.ORDER_ATOMIC]}else if(1==a.itemCount_){var b=Blockly.Lua.valueToCode(a,"ADD0",Blockly.Lua.ORDER_NONE)||"''",c="tostring("+b+")";return[c,Blockly.Lua.ORDER_HIGH]}else if(2==a.itemCount_){var d=Blockly.Lua.valueToCode(a,"ADD0",Blockly.Lua.ORDER_CONCATENATION)||"''",e=Blockly.Lua.valueToCode(a,"ADD1",Blockly.Lua.ORDER_CONCATENATION)||"''",c=d+" .. "+e;return[c,Blockly.Lua.ORDER_CONCATENATION]}else{for(var f=[],g=0;g<a.itemCount_;g++){f[g]=Blockly.Lua.valueToCode(a,"ADD"+g,Blockly.Lua.ORDER_NONE)||"''"}var c="table.concat({"+f.join(", ")+"})";return[c,Blockly.Lua.ORDER_HIGH]}};Blockly.Lua.text_append=function(a){var b=Blockly.Lua.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),c=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_CONCATENATION)||"''";return b+" = "+b+" .. "+c+"\n"};Blockly.Lua.text_length=function(a){var b=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_UNARY)||"''";return["#"+b,Blockly.Lua.ORDER_UNARY]};Blockly.Lua.text_isEmpty=function(a){var b=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_UNARY)||"''";return["#"+b+" == 0",Blockly.Lua.ORDER_RELATIONAL]};Blockly.Lua.text_indexOf=function(a){var b=Blockly.Lua.valueToCode(a,"FIND",Blockly.Lua.ORDER_NONE)||"''",c=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_NONE)||"''";if("FIRST"==a.getFieldValue("END")){var d=Blockly.Lua.provideFunction_("firstIndexOf",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr) ","  local i = string.find(str, substr, 1, true)","  if i == nil then","    return 0","  else","    return i","  end","end"])}else{var d=Blockly.Lua.provideFunction_("lastIndexOf",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr)","  local i = string.find(string.reverse(str), string.reverse(substr), 1, true)","  if i then","    return #str + 2 - i - #substr","  end","  return 0","end"])}var e=d+"("+c+", "+b+")";return[e,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_charAt=function(a){var b=a.getFieldValue("WHERE")||"FROM_START",c="FROM_END"==b?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE,d=Blockly.Lua.valueToCode(a,"AT",c)||"1",e=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_NONE)||"''",f;if("RANDOM"==b){var g=Blockly.Lua.provideFunction_("text_random_letter",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local index = math.random(string.len(str))","  return string.sub(str, index, index)","end"]);f=g+"("+e+")"}else{if("FIRST"==b){var h="1"}else if("LAST"==b){var h="-1"}else{if("FROM_START"==b){var h=d}else if("FROM_END"==b){var h="-"+d}else{throw Error("Unhandled option (text_charAt).")}}if(h.match(/^-?\w*$/)){f="string.sub("+e+", "+h+", "+h+")"}else{var g=Blockly.Lua.provideFunction_("text_char_at",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, index)","  return string.sub(str, index, index)","end"]);f=g+"("+e+", "+h+")"}}return[f,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_getSubstring=function(a){var b=Blockly.Lua.valueToCode(a,"STRING",Blockly.Lua.ORDER_NONE)||"''",c=a.getFieldValue("WHERE1"),d="FROM_END"==c?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE,e=Blockly.Lua.valueToCode(a,"AT1",d)||"1";if("FIRST"==c){var f=1}else if("FROM_START"==c){var f=e}else if("FROM_END"==c){var f="-"+e}else{throw Error("Unhandled option (text_getSubstring)")}var g=a.getFieldValue("WHERE2"),h="FROM_END"==g?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE,i=Blockly.Lua.valueToCode(a,"AT2",h)||"1";if("LAST"==g){var j=-1}else if("FROM_START"==g){var j=i}else if("FROM_END"==g){var j="-"+i}else{throw Error("Unhandled option (text_getSubstring)")}var k="string.sub("+b+", "+f+", "+j+")";return[k,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_changeCase=function(a){var b=a.getFieldValue("CASE"),c=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_NONE)||"''";if("UPPERCASE"==b){var d="string.upper"}else if("LOWERCASE"==b){var d="string.lower"}else if("TITLECASE"==b){var d=Blockly.Lua.provideFunction_("text_titlecase",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local buf = {}","  local inWord = false","  for i = 1, #str do","    local c = string.sub(str, i, i)","    if inWord then","      table.insert(buf, string.lower(c))","      if string.find(c, \"%s\") then","        inWord = false","      end","    else","      table.insert(buf, string.upper(c))","      inWord = true","    end","  end","  return table.concat(buf)","end"])}var e=d+"("+c+")";return[e,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_trim=function(a){var b={LEFT:"^%s*(,-)",RIGHT:"(.-)%s*$",BOTH:"^%s*(.-)%s*$"}[a.getFieldValue("MODE")],c=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_NONE)||"''";return["string.gsub("+c+", \""+b+"\", \"%1\")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_print=function(a){var b=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_NONE)||"''";return"print("+b+")\n"};Blockly.Lua.text_prompt_ext=function(a){if(a.getField("TEXT")){var b=Blockly.Lua.quote_(a.getFieldValue("TEXT"))}else{var b=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_NONE)||"''"}var c=Blockly.Lua.provideFunction_("text_prompt",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(msg)","  io.write(msg)","  io.flush()","  return io.read()","end"]),d=c+"("+b+")",e="NUMBER"==a.getFieldValue("TYPE");if(e){d="tonumber("+d+", 10)"}return[d,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_prompt=Blockly.Lua.text_prompt_ext;Blockly.Lua.text_count=function(a){var b=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_NONE)||"''",c=Blockly.Lua.valueToCode(a,"SUB",Blockly.Lua.ORDER_NONE)||"''",d=Blockly.Lua.provideFunction_("text_count",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle)","  if #needle == 0 then","    return #haystack + 1","  end","  local i = 1","  local count = 0","  while true do","    i = string.find(haystack, needle, i, true)","    if i == nil then","      break","    end","    count = count + 1","    i = i + #needle","  end","  return count","end"]);return[d+"("+b+", "+c+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_replace=function(a){var b=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_NONE)||"''",c=Blockly.Lua.valueToCode(a,"FROM",Blockly.Lua.ORDER_NONE)||"''",d=Blockly.Lua.valueToCode(a,"TO",Blockly.Lua.ORDER_NONE)||"''",e=Blockly.Lua.provideFunction_("text_replace",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement)","  local buf = {}","  local i = 1","  while i <= #haystack do","    if string.sub(haystack, i, i + #needle - 1) == needle then","      for j = 1, #replacement do","        table.insert(buf, string.sub(replacement, j, j))","      end","      i = i + #needle","    else","      table.insert(buf, string.sub(haystack, i, i))","      i = i + 1","    end","  end","  return table.concat(buf)","end"]);return[e+"("+b+", "+c+", "+d+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_reverse=function(a){var b=Blockly.Lua.valueToCode(a,"TEXT",Blockly.Lua.ORDER_HIGH)||"''";return["string.reverse("+b+")",Blockly.Lua.ORDER_HIGH]};
//# sourceMappingURL=text.min.js.map
