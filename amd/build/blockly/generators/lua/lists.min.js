'use strict';goog.provide("Blockly.Lua.lists");goog.require("Blockly.Lua");Blockly.Lua.lists_create_empty=function(){return["{}",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_create_with=function(a){for(var b=Array(a.itemCount_),c=0;c<a.itemCount_;c++){b[c]=Blockly.Lua.valueToCode(a,"ADD"+c,Blockly.Lua.ORDER_NONE)||"None"}var d="{"+b.join(", ")+"}";return[d,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_repeat=function(a){var b=Blockly.Lua.provideFunction_("create_list_repeated",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(item, count)","  local t = {}","  for i = 1, count do","    table.insert(t, item)","  end","  return t","end"]),c=Blockly.Lua.valueToCode(a,"ITEM",Blockly.Lua.ORDER_NONE)||"None",d=Blockly.Lua.valueToCode(a,"NUM",Blockly.Lua.ORDER_NONE)||"0";return[b+"("+c+", "+d+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_length=function(a){var b=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_UNARY)||"{}";return["#"+b,Blockly.Lua.ORDER_UNARY]};Blockly.Lua.lists_isEmpty=function(a){var b=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_UNARY)||"{}";return["#"+b+" == 0",Blockly.Lua.ORDER_RELATIONAL]};Blockly.Lua.lists_indexOf=function(a){var b=Blockly.Lua.valueToCode(a,"FIND",Blockly.Lua.ORDER_NONE)||"''",c=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_NONE)||"{}";if("FIRST"==a.getFieldValue("END")){var d=Blockly.Lua.provideFunction_("first_index",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for k, v in ipairs(t) do","    if v == elem then","      return k","    end","  end","  return 0","end"])}else{var d=Blockly.Lua.provideFunction_("last_index",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for i = #t, 1, -1 do","    if t[i] == elem then","      return i","    end","  end","  return 0","end"])}var e=d+"("+c+", "+b+")";return[e,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists.getIndex_=function(a,b,c){if("FIRST"==b){return"1"}else if("FROM_END"==b){return"#"+a+" + 1 - "+c}else if("LAST"==b){return"#"+a}else if("RANDOM"==b){return"math.random(#"+a+")"}else{return c}};Blockly.Lua.lists_getIndex=function(a){var b=a.getFieldValue("MODE")||"GET",c=a.getFieldValue("WHERE")||"FROM_START",d=Blockly.Lua.valueToCode(a,"VALUE",Blockly.Lua.ORDER_HIGH)||"({})",e=Blockly.Lua.lists.getIndex_;if(("LAST"==c||"FROM_END"==c||"RANDOM"==c)&&!d.match(/^\w+$/)){if("REMOVE"==b){var f="FROM_END"==c?Blockly.Lua.ORDER_ADDITIVE:Blockly.Lua.ORDER_NONE,g=Blockly.Lua.valueToCode(a,"AT",f)||"1",h=Blockly.Lua.variableDB_.getDistinctName("tmp_list",Blockly.VARIABLE_CATEGORY_NAME);g=e(h,c,g);var i=h+" = "+d+"\ntable.remove("+h+", "+g+")\n";return i}else{var g=Blockly.Lua.valueToCode(a,"AT",Blockly.Lua.ORDER_NONE)||"1";if("GET"==b){var j=Blockly.Lua.provideFunction_("list_get_"+c.toLowerCase(),["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==c||"FROM_START"==c?", at)":")"),"  return t["+e("t",c,"at")+"]","end"])}else{var j=Blockly.Lua.provideFunction_("list_remove_"+c.toLowerCase(),["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==c||"FROM_START"==c?", at)":")"),"  return table.remove(t, "+e("t",c,"at")+")","end"])}var i=j+"("+d+("FROM_END"==c||"FROM_START"==c?", "+g:"")+")";return[i,Blockly.Lua.ORDER_HIGH]}}else{var f="GET"==b&&"FROM_END"==c?Blockly.Lua.ORDER_ADDITIVE:Blockly.Lua.ORDER_NONE,g=Blockly.Lua.valueToCode(a,"AT",f)||"1";g=e(d,c,g);if("GET"==b){var i=d+"["+g+"]";return[i,Blockly.Lua.ORDER_HIGH]}else{var i="table.remove("+d+", "+g+")";if("GET_REMOVE"==b){return[i,Blockly.Lua.ORDER_HIGH]}else{return i+"\n"}}}};Blockly.Lua.lists_setIndex=function(a){var b=Blockly.Lua.valueToCode(a,"LIST",Blockly.Lua.ORDER_HIGH)||"{}",c=a.getFieldValue("MODE")||"SET",d=a.getFieldValue("WHERE")||"FROM_START",e=Blockly.Lua.valueToCode(a,"AT",Blockly.Lua.ORDER_ADDITIVE)||"1",f=Blockly.Lua.valueToCode(a,"TO",Blockly.Lua.ORDER_NONE)||"None",g=Blockly.Lua.lists.getIndex_,h="";if(("LAST"==d||"FROM_END"==d||"RANDOM"==d)&&!b.match(/^\w+$/)){var i=Blockly.Lua.variableDB_.getDistinctName("tmp_list",Blockly.VARIABLE_CATEGORY_NAME);h=i+" = "+b+"\n";b=i}if("SET"==c){h+=b+"["+g(b,d,e)+"] = "+f}else{h+="table.insert("+b+", "+(g(b,d,e)+("LAST"==d?" + 1":""))+", "+f+")"}return h+"\n"};Blockly.Lua.lists_getSublist=function(a){var b=Blockly.Lua.valueToCode(a,"LIST",Blockly.Lua.ORDER_NONE)||"{}",c=a.getFieldValue("WHERE1"),d=a.getFieldValue("WHERE2"),e=Blockly.Lua.valueToCode(a,"AT1",Blockly.Lua.ORDER_NONE)||"1",f=Blockly.Lua.valueToCode(a,"AT2",Blockly.Lua.ORDER_NONE)||"1",g=Blockly.Lua.lists.getIndex_,h=Blockly.Lua.provideFunction_("list_sublist_"+c.toLowerCase()+"_"+d.toLowerCase(),["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(source"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==d||"FROM_START"==d?", at2":"")+")","  local t = {}","  local start = "+g("source",c,"at1"),"  local finish = "+g("source",d,"at2"),"  for i = start, finish do","    table.insert(t, source[i])","  end","  return t","end"]),i=h+"("+b+("FROM_END"==c||"FROM_START"==c?", "+e:"")+("FROM_END"==d||"FROM_START"==d?", "+f:"")+")";return[i,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_sort=function(a){var b=Blockly.Lua.valueToCode(a,"LIST",Blockly.Lua.ORDER_NONE)||"{}",c="1"===a.getFieldValue("DIRECTION")?1:-1,d=a.getFieldValue("TYPE"),e=Blockly.Lua.provideFunction_("list_sort",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(list, typev, direction)","  local t = {}","  for n,v in pairs(list) do table.insert(t, v) end","  local compareFuncs = {","    NUMERIC = function(a, b)","      return (tonumber(tostring(a)) or 0)","          < (tonumber(tostring(b)) or 0) end,","    TEXT = function(a, b)","      return tostring(a) < tostring(b) end,","    IGNORE_CASE = function(a, b)","      return string.lower(tostring(a)) < string.lower(tostring(b)) end","  }","  local compareTemp = compareFuncs[typev]","  local compare = compareTemp","  if direction == -1","  then compare = function(a, b) return compareTemp(b, a) end","  end","  table.sort(t, compare)","  return t","end"]);return[e+"("+b+",\""+d+"\", "+c+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_split=function(a){var b=Blockly.Lua.valueToCode(a,"INPUT",Blockly.Lua.ORDER_NONE),c=Blockly.Lua.valueToCode(a,"DELIM",Blockly.Lua.ORDER_NONE)||"''",d=a.getFieldValue("MODE"),e;if("SPLIT"==d){if(!b){b="''"}e=Blockly.Lua.provideFunction_("list_string_split",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input, delim)","  local t = {}","  local pos = 1","  while true do","    next_delim = string.find(input, delim, pos)","    if next_delim == nil then","      table.insert(t, string.sub(input, pos))","      break","    else","      table.insert(t, string.sub(input, pos, next_delim-1))","      pos = next_delim + #delim","    end","  end","  return t","end"])}else if("JOIN"==d){if(!b){b="{}"}e="table.concat"}else{throw Error("Unknown mode: "+d)}var f=e+"("+b+", "+c+")";return[f,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_reverse=function(a){var b=Blockly.Lua.valueToCode(a,"LIST",Blockly.Lua.ORDER_NONE)||"{}",c=Blockly.Lua.provideFunction_("list_reverse",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input)","  local reversed = {}","  for i = #input, 1, -1 do","    table.insert(reversed, input[i])","  end","  return reversed","end"]);return[c+"("+b+")",Blockly.Lua.ORDER_HIGH]};
//# sourceMappingURL=lists.min.js.map
