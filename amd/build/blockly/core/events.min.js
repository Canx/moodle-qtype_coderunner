'use strict';goog.provide("Blockly.Events");goog.require("Blockly.utils");Blockly.Events.group_="";Blockly.Events.recordUndo=!0;Blockly.Events.disabled_=0;Blockly.Events.CREATE="create";Blockly.Events.BLOCK_CREATE=Blockly.Events.CREATE;Blockly.Events.DELETE="delete";Blockly.Events.BLOCK_DELETE=Blockly.Events.DELETE;Blockly.Events.CHANGE="change";Blockly.Events.BLOCK_CHANGE=Blockly.Events.CHANGE;Blockly.Events.MOVE="move";Blockly.Events.BLOCK_MOVE=Blockly.Events.MOVE;Blockly.Events.VAR_CREATE="var_create";Blockly.Events.VAR_DELETE="var_delete";Blockly.Events.VAR_RENAME="var_rename";Blockly.Events.UI="ui";Blockly.Events.COMMENT_CREATE="comment_create";Blockly.Events.COMMENT_DELETE="comment_delete";Blockly.Events.COMMENT_CHANGE="comment_change";Blockly.Events.COMMENT_MOVE="comment_move";Blockly.Events.FINISHED_LOADING="finished_loading";Blockly.Events.BUMP_EVENTS=[Blockly.Events.BLOCK_CREATE,Blockly.Events.BLOCK_MOVE,Blockly.Events.COMMENT_CREATE,Blockly.Events.COMMENT_MOVE];Blockly.Events.FIRE_QUEUE_=[];Blockly.Events.fire=function(a){if(!Blockly.Events.isEnabled()){return}if(!Blockly.Events.FIRE_QUEUE_.length){setTimeout(Blockly.Events.fireNow_,0)}Blockly.Events.FIRE_QUEUE_.push(a)};Blockly.Events.fireNow_=function(){var a=Blockly.Events.filter(Blockly.Events.FIRE_QUEUE_,!0);Blockly.Events.FIRE_QUEUE_.length=0;for(var b=0,c;c=a[b];b++){if(!c.workspaceId){continue}var d=Blockly.Workspace.getById(c.workspaceId);if(d){d.fireChangeListener(c)}}};Blockly.Events.filter=function(a,b){var c=a.slice();if(!b){c.reverse()}for(var d=[],e=Object.create(null),f=0,g;g=c[f];f++){if(!g.isNull()){var h=[g.type,g.blockId,g.workspaceId].join(" "),j=e[h],k=j?j.event:null;if(!j){e[h]={event:g,index:f};d.push(g)}else if(g.type==Blockly.Events.MOVE&&j.index==f-1){k.newParentId=g.newParentId;k.newInputName=g.newInputName;k.newCoordinate=g.newCoordinate;j.index=f}else if(g.type==Blockly.Events.CHANGE&&g.element==k.element&&g.name==k.name){k.newValue=g.newValue}else if(!(g.type==Blockly.Events.UI&&"click"==g.element&&("commentOpen"==k.element||"mutatorOpen"==k.element||"warningOpen"==k.element))){e[h]={event:g,index:1};d.push(g)}}}c=d.filter(function(a){return!a.isNull()});if(!b){c.reverse()}for(var f=1,g;g=c[f];f++){if(g.type==Blockly.Events.CHANGE&&"mutation"==g.element){c.unshift(c.splice(f,1)[0])}}return c};Blockly.Events.clearPendingUndo=function(){for(var a=0,b;b=Blockly.Events.FIRE_QUEUE_[a];a++){b.recordUndo=!1}};Blockly.Events.disable=function(){Blockly.Events.disabled_++};Blockly.Events.enable=function(){Blockly.Events.disabled_--};Blockly.Events.isEnabled=function(){return 0==Blockly.Events.disabled_};Blockly.Events.getGroup=function(){return Blockly.Events.group_};Blockly.Events.setGroup=function(a){if("boolean"==typeof a){Blockly.Events.group_=a?Blockly.utils.genUid():""}else{Blockly.Events.group_=a}};Blockly.Events.getDescendantIds=function(a){for(var b=[],c=a.getDescendants(!1),d=0,e;e=c[d];d++){b[d]=e.id}return b};Blockly.Events.fromJson=function(a,b){var c;switch(a.type){case Blockly.Events.CREATE:c=new Blockly.Events.Create(null);break;case Blockly.Events.DELETE:c=new Blockly.Events.Delete(null);break;case Blockly.Events.CHANGE:c=new Blockly.Events.Change(null,"","","","");break;case Blockly.Events.MOVE:c=new Blockly.Events.Move(null);break;case Blockly.Events.VAR_CREATE:c=new Blockly.Events.VarCreate(null);break;case Blockly.Events.VAR_DELETE:c=new Blockly.Events.VarDelete(null);break;case Blockly.Events.VAR_RENAME:c=new Blockly.Events.VarRename(null,"");break;case Blockly.Events.UI:c=new Blockly.Events.Ui(null,"","","");break;case Blockly.Events.COMMENT_CREATE:c=new Blockly.Events.CommentCreate(null);break;case Blockly.Events.COMMENT_CHANGE:c=new Blockly.Events.CommentChange(null,"","");break;case Blockly.Events.COMMENT_MOVE:c=new Blockly.Events.CommentMove(null);break;case Blockly.Events.COMMENT_DELETE:c=new Blockly.Events.CommentDelete(null);break;case Blockly.Events.FINISHED_LOADING:c=new Blockly.Events.FinishedLoading(b);break;default:throw Error("Unknown event type.");}c.fromJson(a);c.workspaceId=b.id;return c};Blockly.Events.disableOrphans=function(a){if(a.type==Blockly.Events.MOVE||a.type==Blockly.Events.CREATE){if(!a.workspaceId){return}var b=Blockly.Workspace.getById(a.workspaceId),c=b.getBlockById(a.blockId);if(c){var d=c.getParent();if(d&&d.isEnabled()){for(var e=c.getDescendants(!1),f=0,g;g=e[f];f++){g.setEnabled(!0)}}else if((c.outputConnection||c.previousConnection)&&!b.isDragging()){do{c.setEnabled(!1);c=c.getNextBlock()}while(c)}}}};
//# sourceMappingURL=events.min.js.map
