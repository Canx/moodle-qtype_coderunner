{"version":3,"sources":["../../../src/blockly/core/dropdowndiv.js"],"names":["goog","provide","require","requireType","Blockly","DropDownDiv","boundsElement_","owner_","positionToField_","ARROW_SIZE","BORDER_SIZE","ARROW_HORIZONTAL_PADDING","PADDING_Y","ANIMATION_TIME","animateOutTimer_","onHide_","rendererClassName_","themeClassName_","BoundsInfo","PositionMetrics","createDom","DIV_","div","document","createElement","className","container","parentContainer","body","appendChild","content","content_","arrow","arrow_","style","opacity","transition","addEventListener","utils","dom","addClass","removeClass","setBoundsElement","boundsElement","getContentDiv","clearContent","textContent","width","setColour","backgroundColour","borderColour","backgroundColor","borderColor","showPositionedByBlock","field","block","opt_onHide","opt_secondaryYOffset","showPositionedByRect_","getScaledBboxOfBlock_","showPositionedByField","getScaledBboxOfField_","blockSvg","getSvgRoot","bBox","getBBox","scale","workspace","scaledHeight","height","scaledWidth","xy","getPageOffset","Rect","y","x","getScaledBBox","top","bottom","left","right","primaryX","primaryY","secondaryY","sourceBlock","getSourceBlock","options","parentWorkspace","getParentSvg","parentNode","show","RTL","owner","rtl","secondaryX","direction","mainWorkspace","getMainWorkspace","getRenderer","getClassName","getTheme","positionInternal_","getBoundsInfo_","boundPosition","boundSize","getSize","getPositionMetrics_","boundsInfo","divSize","getPositionBelowMetrics_","getPositionAboveMetrics_","documentElement","clientHeight","clientTop","getPositionTopOfPageMetrics_","xCoords","getPositionX","arrowY","finalY","initialX","divX","initialY","finalX","arrowX","arrowAtTop","arrowVisible","sourceX","boundsLeft","boundsRight","divWidth","math","clamp","relativeArrowX","horizPadding","isVisible","hideIfOwner","opt_withoutAnimation","hideWithoutAnimation","hide","transform","setTimeout","clearTimeout","display","markFocused","metrics","setAttribute","Math","floor","repositionForWindowResize"],"mappings":"AAaA,aAEAA,IAAI,CAACC,OAAL,CAAa,qBAAb,EAEAD,IAAI,CAACE,OAAL,CAAa,mBAAb,EACAF,IAAI,CAACE,OAAL,CAAa,oBAAb,EACAF,IAAI,CAACE,OAAL,CAAa,qBAAb,EAEAF,IAAI,CAACG,WAAL,CAAiB,oBAAjB,EACAH,IAAI,CAACG,WAAL,CAAiB,oBAAjB,EAQAC,OAAO,CAACC,WAAR,CAAsB,UAAW,CAChC,CADD,CASAD,OAAO,CAACC,WAAR,CAAoBC,cAApB,CAAqC,IAArC,CAOAF,OAAO,CAACC,WAAR,CAAoBE,MAApB,CAA6B,IAA7B,CAOAH,OAAO,CAACC,WAAR,CAAoBG,gBAApB,CAAuC,IAAvC,CAQAJ,OAAO,CAACC,WAAR,CAAoBI,UAApB,CAAiC,EAAjC,CAQAL,OAAO,CAACC,WAAR,CAAoBK,WAApB,CAAkC,CAAlC,CAQAN,OAAO,CAACC,WAAR,CAAoBM,wBAApB,CAA+C,EAA/C,CAOAP,OAAO,CAACC,WAAR,CAAoBO,SAApB,CAAgC,EAAhC,CAOAR,OAAO,CAACC,WAAR,CAAoBQ,cAApB,CAAqC,GAArC,CAQAT,OAAO,CAACC,WAAR,CAAoBS,gBAApB,CAAuC,IAAvC,CAOAV,OAAO,CAACC,WAAR,CAAoBU,OAApB,CAA8B,IAA9B,CAOAX,OAAO,CAACC,WAAR,CAAoBW,kBAApB,CAAyC,EAAzC,CAOAZ,OAAO,CAACC,WAAR,CAAoBY,eAApB,CAAsC,EAAtC,CAcAb,OAAO,CAACC,WAAR,CAAoBa,UAApB,CAeAd,OAAO,CAACC,WAAR,CAAoBc,eAApB,CAMAf,OAAO,CAACC,WAAR,CAAoBe,SAApB,CAAgC,UAAW,CACzC,GAAIhB,OAAO,CAACC,WAAR,CAAoBgB,IAAxB,CAA8B,CAC5B,MACD,CACD,GAAIC,CAAAA,CAAG,CAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAV,CACAF,CAAG,CAACG,SAAJ,CAAgB,oBAAhB,CACA,GAAIC,CAAAA,CAAS,CAAGtB,OAAO,CAACuB,eAAR,EAA2BJ,QAAQ,CAACK,IAApD,CACAF,CAAS,CAACG,WAAV,CAAsBP,CAAtB,EAMAlB,OAAO,CAACC,WAAR,CAAoBgB,IAApB,CAA2BC,CAA3B,CAEA,GAAIQ,CAAAA,CAAO,CAAGP,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAd,CACAM,CAAO,CAACL,SAAR,CAAoB,wBAApB,CACAH,CAAG,CAACO,WAAJ,CAAgBC,CAAhB,EAMA1B,OAAO,CAACC,WAAR,CAAoB0B,QAApB,CAA+BD,CAA/B,CAEA,GAAIE,CAAAA,CAAK,CAAGT,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAZ,CACAQ,CAAK,CAACP,SAAN,CAAkB,sBAAlB,CACAH,CAAG,CAACO,WAAJ,CAAgBG,CAAhB,EAMA5B,OAAO,CAACC,WAAR,CAAoB4B,MAApB,CAA6BD,CAA7B,CAEA5B,OAAO,CAACC,WAAR,CAAoBgB,IAApB,CAAyBa,KAAzB,CAA+BC,OAA/B,CAAyC,CAAzC,CAGA/B,OAAO,CAACC,WAAR,CAAoBgB,IAApB,CAAyBa,KAAzB,CAA+BE,UAA/B,CAA4C,aAC1ChC,OAAO,CAACC,WAAR,CAAoBQ,cADsB,eAE7BT,OAAO,CAACC,WAAR,CAAoBQ,cAFS,CAEQ,GAFpD,CAMAS,CAAG,CAACe,gBAAJ,CAAqB,SAArB,CAAgC,UAAW,CACzCjC,OAAO,CAACkC,KAAR,CAAcC,GAAd,CAAkBC,QAAlB,CAA2BlB,CAA3B,CAAgC,gBAAhC,CACD,CAFD,EAGAA,CAAG,CAACe,gBAAJ,CAAqB,UAArB,CAAiC,UAAW,CAC1CjC,OAAO,CAACkC,KAAR,CAAcC,GAAd,CAAkBE,WAAlB,CAA8BnB,CAA9B,CAAmC,gBAAnC,CACD,CAFD,CAGD,CAlDD,CAyDAlB,OAAO,CAACC,WAAR,CAAoBqC,gBAApB,CAAuC,SAASC,CAAT,CAAwB,CAC7DvC,OAAO,CAACC,WAAR,CAAoBC,cAApB,CAAqCqC,CACtC,CAFD,CAQAvC,OAAO,CAACC,WAAR,CAAoBuC,aAApB,CAAoC,UAAW,CAC7C,MAAOxC,CAAAA,OAAO,CAACC,WAAR,CAAoB0B,QAC5B,CAFD,CAOA3B,OAAO,CAACC,WAAR,CAAoBwC,YAApB,CAAmC,UAAW,CAC5CzC,OAAO,CAACC,WAAR,CAAoB0B,QAApB,CAA6Be,WAA7B,CAA2C,EAA3C,CACA1C,OAAO,CAACC,WAAR,CAAoB0B,QAApB,CAA6BG,KAA7B,CAAmCa,KAAnC,CAA2C,EAC5C,CAHD,CAUA3C,OAAO,CAACC,WAAR,CAAoB2C,SAApB,CAAgC,SAASC,CAAT,CAA2BC,CAA3B,CAAyC,CACvE9C,OAAO,CAACC,WAAR,CAAoBgB,IAApB,CAAyBa,KAAzB,CAA+BiB,eAA/B,CAAiDF,CAAjD,CACA7C,OAAO,CAACC,WAAR,CAAoBgB,IAApB,CAAyBa,KAAzB,CAA+BkB,WAA/B,CAA6CF,CAC9C,CAHD,CAkBA9C,OAAO,CAACC,WAAR,CAAoBgD,qBAApB,CAA4C,SAASC,CAAT,CAAgBC,CAAhB,CACxCC,CADwC,CAC5BC,CAD4B,CACN,CACpC,MAAOrD,CAAAA,OAAO,CAACC,WAAR,CAAoBqD,qBAApB,CACHtD,OAAO,CAACC,WAAR,CAAoBsD,qBAApB,CAA0CJ,CAA1C,CADG,CAEHD,CAFG,CAEIE,CAFJ,CAEgBC,CAFhB,CAGR,CALD,CAmBArD,OAAO,CAACC,WAAR,CAAoBuD,qBAApB,CAA4C,SAASN,CAAT,CACxCE,CADwC,CAC5BC,CAD4B,CACN,CACpCrD,OAAO,CAACC,WAAR,CAAoBG,gBAApB,IACA,MAAOJ,CAAAA,OAAO,CAACC,WAAR,CAAoBqD,qBAApB,CACHtD,OAAO,CAACC,WAAR,CAAoBwD,qBAApB,CAA0CP,CAA1C,CADG,CAEHA,CAFG,CAEIE,CAFJ,CAEgBC,CAFhB,CAGR,CAND,CAcArD,OAAO,CAACC,WAAR,CAAoBsD,qBAApB,CAA4C,SAASJ,CAAT,CAAgB,IACtDO,CAAAA,CAAQ,CAAGP,CAAK,CAACQ,UAAN,EAD2C,CAEtDC,CAAI,CAAGF,CAAQ,CAACG,OAAT,EAF+C,CAGtDC,CAAK,CAAGX,CAAK,CAACY,SAAN,CAAgBD,KAH8B,CAItDE,CAAY,CAAGJ,CAAI,CAACK,MAAL,CAAcH,CAJyB,CAKtDI,CAAW,CAAGN,CAAI,CAACjB,KAAL,CAAamB,CAL2B,CAMtDK,CAAE,CAAGnE,OAAO,CAACkC,KAAR,CAAcJ,KAAd,CAAoBsC,aAApB,CAAkCV,CAAlC,CANiD,CAO1D,MAAO,IAAI1D,CAAAA,OAAO,CAACkC,KAAR,CAAcmC,IAAlB,CACHF,CAAE,CAACG,CADA,CACGH,CAAE,CAACG,CAAH,CAAON,CADV,CACwBG,CAAE,CAACI,CAD3B,CAC8BJ,CAAE,CAACI,CAAH,CAAOL,CADrC,CAER,CATD,CAiBAlE,OAAO,CAACC,WAAR,CAAoBwD,qBAApB,CAA4C,SAASP,CAAT,CAAgB,CAC1D,GAAIU,CAAAA,CAAI,CAAGV,CAAK,CAACsB,aAAN,EAAX,CACA,MAAO,IAAIxE,CAAAA,OAAO,CAACkC,KAAR,CAAcmC,IAAlB,CACHT,CAAI,CAACa,GADF,CACOb,CAAI,CAACc,MADZ,CACoBd,CAAI,CAACe,IADzB,CAC+Bf,CAAI,CAACgB,KADpC,CAER,CAJD,CAoBA5E,OAAO,CAACC,WAAR,CAAoBqD,qBAApB,CAA4C,SAASM,CAAT,CAAeV,CAAf,CACxCE,CADwC,CAC5BC,CAD4B,CACN,IAEhCwB,CAAAA,CAAQ,CAAGjB,CAAI,CAACe,IAAL,CAAY,CAACf,CAAI,CAACgB,KAAL,CAAahB,CAAI,CAACe,IAAnB,EAA2B,CAFlB,CAGhCG,CAAQ,CAAGlB,CAAI,CAACc,MAHgB,CAMhCK,CAAU,CAAGnB,CAAI,CAACa,GANc,CAOpC,GAAIpB,CAAJ,CAA0B,CACxB0B,CAAU,EAAI1B,CACf,CATmC,GAUhC2B,CAAAA,CAAW,CAAqC9B,CAAK,CAAC+B,cAAN,EAVhB,CAYhClB,CAAS,CAAGiB,CAAW,CAACjB,SAZQ,CAapC,MAAOA,CAAS,CAACmB,OAAV,CAAkBC,eAAzB,CAA0C,CACxCpB,CAAS,CACPA,CAAS,CAACmB,OAAV,CAAkBC,eACrB,CACDnF,OAAO,CAACC,WAAR,CAAoBqC,gBAApB,CAC4ByB,CAAS,CAACqB,YAAV,GAAyBC,UADrD,EAEA,MAAOrF,CAAAA,OAAO,CAACC,WAAR,CAAoBqF,IAApB,CACHpC,CADG,CACI8B,CAAW,CAACO,GADhB,CAEHV,CAFG,CAEOC,CAFP,CAdUD,CAcV,CAE6BE,CAF7B,CAEyC3B,CAFzC,CAGR,CAvBD,CA8CApD,OAAO,CAACC,WAAR,CAAoBqF,IAApB,CAA2B,SAASE,CAAT,CAAgBC,CAAhB,CAAqBZ,CAArB,CAA+BC,CAA/B,CACvBY,CADuB,CACXX,CADW,CACC3B,CADD,CACa,CACtCpD,OAAO,CAACC,WAAR,CAAoBE,MAApB,CAA6BqF,CAA7B,CACAxF,OAAO,CAACC,WAAR,CAAoBU,OAApB,CAA8ByC,CAAU,EAAI,IAA5C,CAEA,GAAIlC,CAAAA,CAAG,CAAGlB,OAAO,CAACC,WAAR,CAAoBgB,IAA9B,CACAC,CAAG,CAACY,KAAJ,CAAU6D,SAAV,CAAsBF,CAAG,CAAG,KAAH,CAAW,KAApC,CAEA,GAAIG,CAAAA,CAAa,CACuB5F,OAAO,CAAC6F,gBAAR,EADxC,CAEA7F,OAAO,CAACC,WAAR,CAAoBW,kBAApB,CACIgF,CAAa,CAACE,WAAd,GAA4BC,YAA5B,EADJ,CAEA/F,OAAO,CAACC,WAAR,CAAoBY,eAApB,CAAsC+E,CAAa,CAACI,QAAd,GAAyBD,YAAzB,EAAtC,CACA/F,OAAO,CAACkC,KAAR,CAAcC,GAAd,CAAkBC,QAAlB,CAA2BlB,CAA3B,CAAgClB,OAAO,CAACC,WAAR,CAAoBW,kBAApD,EACAZ,OAAO,CAACkC,KAAR,CAAcC,GAAd,CAAkBC,QAAlB,CAA2BlB,CAA3B,CAAgClB,OAAO,CAACC,WAAR,CAAoBY,eAApD,EAWA,MAAOb,CAAAA,OAAO,CAACC,WAAR,CAAoBgG,iBAApB,CACHpB,CADG,CACOC,CADP,CACiBY,CADjB,CAC6BX,CAD7B,CAER,CA3BD,CAmCA/E,OAAO,CAACC,WAAR,CAAoBiG,cAApB,CAAqC,UAAW,IAC1CC,CAAAA,CAAa,CAAGnG,OAAO,CAACkC,KAAR,CAAcJ,KAAd,CAAoBsC,aAApB,CACSpE,OAAO,CAACC,WAAR,CAAoBC,cAD7B,CAD0B,CAG1CkG,CAAS,CAAGpG,OAAO,CAACkC,KAAR,CAAcJ,KAAd,CAAoBuE,OAApB,CACarG,OAAO,CAACC,WAAR,CAAoBC,cADjC,CAH8B,CAM9C,MAAO,CACLyE,IAAI,CAAEwB,CAAa,CAAC5B,CADf,CAELK,KAAK,CAAEuB,CAAa,CAAC5B,CAAd,CAAkB6B,CAAS,CAACzD,KAF9B,CAGL8B,GAAG,CAAE0B,CAAa,CAAC7B,CAHd,CAILI,MAAM,CAAEyB,CAAa,CAAC7B,CAAd,CAAkB8B,CAAS,CAACnC,MAJ/B,CAKLtB,KAAK,CAAEyD,CAAS,CAACzD,KALZ,CAMLsB,MAAM,CAAEmC,CAAS,CAACnC,MANb,CAQR,CAdD,CA6BAjE,OAAO,CAACC,WAAR,CAAoBqG,mBAApB,CAA0C,SAASzB,CAAT,CAAmBC,CAAnB,CACtCY,CADsC,CAC1BX,CAD0B,CACd,IACtBwB,CAAAA,CAAU,CAAGvG,OAAO,CAACC,WAAR,CAAoBiG,cAApB,EADS,CAEtBM,CAAO,CAAGxG,OAAO,CAACkC,KAAR,CAAcJ,KAAd,CAAoBuE,OAApB,CACerG,OAAO,CAACC,WAAR,CAAoBgB,IADnC,CAFY,CAM1B,GAAI6D,CAAQ,CAAG0B,CAAO,CAACvC,MAAnB,CAA4BsC,CAAU,CAAC7B,MAA3C,CAAmD,CACjD,MAAO1E,CAAAA,OAAO,CAACC,WAAR,CAAoBwG,wBAApB,CACH5B,CADG,CACOC,CADP,CACiByB,CADjB,CAC6BC,CAD7B,CAER,CAED,GAAIzB,CAAU,CAAGyB,CAAO,CAACvC,MAArB,CAA8BsC,CAAU,CAAC9B,GAA7C,CAAkD,CAChD,MAAOzE,CAAAA,OAAO,CAACC,WAAR,CAAoByG,wBAApB,CACHhB,CADG,CACSX,CADT,CACqBwB,CADrB,CACiCC,CADjC,CAER,CAED,GAAI1B,CAAQ,CAAG0B,CAAO,CAACvC,MAAnB,CAA4B9C,QAAQ,CAACwF,eAAT,CAAyBC,YAAzD,CAAuE,CACrE,MAAO5G,CAAAA,OAAO,CAACC,WAAR,CAAoBwG,wBAApB,CACH5B,CADG,CACOC,CADP,CACiByB,CADjB,CAC6BC,CAD7B,CAER,CAED,GAAIzB,CAAU,CAAGyB,CAAO,CAACvC,MAArB,CAA8B9C,QAAQ,CAACwF,eAAT,CAAyBE,SAA3D,CAAsE,CACpE,MAAO7G,CAAAA,OAAO,CAACC,WAAR,CAAoByG,wBAApB,CACHhB,CADG,CACSX,CADT,CACqBwB,CADrB,CACiCC,CADjC,CAER,CAGD,MAAOxG,CAAAA,OAAO,CAACC,WAAR,CAAoB6G,4BAApB,CACHjC,CADG,CACO0B,CADP,CACmBC,CADnB,CAER,CA9BD,CA4CAxG,OAAO,CAACC,WAAR,CAAoBwG,wBAApB,CAA+C,SAC3C5B,CAD2C,CACjCC,CADiC,CACvByB,CADuB,CACXC,CADW,CACF,IAEvCO,CAAAA,CAAO,CAAG/G,OAAO,CAACC,WAAR,CAAoB+G,YAApB,CACVnC,CADU,CACA0B,CAAU,CAAC5B,IADX,CACiB4B,CAAU,CAAC3B,KAD5B,CACmC4B,CAAO,CAAC7D,KAD3C,CAF6B,CAKvCsE,CAAM,CAAG,EAAEjH,OAAO,CAACC,WAAR,CAAoBI,UAApB,CAAiC,CAAjC,CACXL,OAAO,CAACC,WAAR,CAAoBK,WADX,CAL8B,CAOvC4G,CAAM,CAAGpC,CAAQ,CAAG9E,OAAO,CAACC,WAAR,CAAoBO,SAPD,CAS3C,MAAO,CACL2G,QAAQ,CAAEJ,CAAO,CAACK,IADb,CAELC,QAAQ,CAAGvC,CAFN,CAGLwC,MAAM,CAAEP,CAAO,CAACK,IAHX,CAILF,MAAM,CAAEA,CAJH,CAKLK,MAAM,CAAER,CAAO,CAACQ,MALX,CAMLN,MAAM,CAAEA,CANH,CAOLO,UAAU,GAPL,CAQLC,YAAY,GARP,CAUR,CApBD,CAoCAzH,OAAO,CAACC,WAAR,CAAoByG,wBAApB,CAA+C,SAC3ChB,CAD2C,CAC/BX,CAD+B,CACnBwB,CADmB,CACPC,CADO,CACE,IAE3CO,CAAAA,CAAO,CAAG/G,OAAO,CAACC,WAAR,CAAoB+G,YAApB,CACVtB,CADU,CACEa,CAAU,CAAC5B,IADb,CACmB4B,CAAU,CAAC3B,KAD9B,CACqC4B,CAAO,CAAC7D,KAD7C,CAFiC,CAK3CsE,CAAM,CAAGT,CAAO,CAACvC,MAAR,CAAoD,CAAlC,CAAAjE,OAAO,CAACC,WAAR,CAAoBK,WAAtC,CACRN,OAAO,CAACC,WAAR,CAAoBI,UAApB,CAAiC,CANS,CAO3C6G,CAAM,CAAGnC,CAAU,CAAGyB,CAAO,CAACvC,MAArB,CAA8BjE,OAAO,CAACC,WAAR,CAAoBO,SAPhB,CAQ3C6G,CAAQ,CAAGtC,CAAU,CAAGyB,CAAO,CAACvC,MARW,CAU/C,MAAO,CACLkD,QAAQ,CAAEJ,CAAO,CAACK,IADb,CAELC,QAAQ,CAAGA,CAFN,CAGLC,MAAM,CAAEP,CAAO,CAACK,IAHX,CAILF,MAAM,CAAEA,CAJH,CAKLK,MAAM,CAAER,CAAO,CAACQ,MALX,CAMLN,MAAM,CAAEA,CANH,CAOLO,UAAU,GAPL,CAQLC,YAAY,GARP,CAUR,CArBD,CAkCAzH,OAAO,CAACC,WAAR,CAAoB6G,4BAApB,CAAmD,SAC/CY,CAD+C,CACtCnB,CADsC,CAC1BC,CAD0B,CACjB,CAEhC,GAAIO,CAAAA,CAAO,CAAG/G,OAAO,CAACC,WAAR,CAAoB+G,YAApB,CACVU,CADU,CACDnB,CAAU,CAAC5B,IADV,CACgB4B,CAAU,CAAC3B,KAD3B,CACkC4B,CAAO,CAAC7D,KAD1C,CAAd,CAIA,MAAO,CACLwE,QAAQ,CAAEJ,CAAO,CAACK,IADb,CAELC,QAAQ,CAAG,CAFN,CAGLC,MAAM,CAAEP,CAAO,CAACK,IAHX,CAILF,MAAM,CAAE,CAJH,CAKLM,UAAU,CAAE,IALP,CAMLD,MAAM,CAAE,IANH,CAOLN,MAAM,CAAE,IAPH,CAQLQ,YAAY,GARP,CAUR,CAjBD,CAgCAzH,OAAO,CAACC,WAAR,CAAoB+G,YAApB,CAAmC,SAC/BU,CAD+B,CACtBC,CADsB,CACVC,CADU,CACGC,CADH,CACa,CAC9C,GAAIN,CAAAA,CAAJ,CAAYH,CAAZ,CACAG,CAAM,CAAGH,CAAI,CAAGM,CAAhB,CAGAN,CAAI,EAAIS,CAAQ,CAAG,CAAnB,CAEAT,CAAI,CAAGpH,OAAO,CAACkC,KAAR,CAAc4F,IAAd,CAAmBC,KAAnB,CAAyBJ,CAAzB,CAAqCP,CAArC,CAA2CQ,CAAW,CAAGC,CAAzD,CAAP,CAGAN,CAAM,EAAIvH,OAAO,CAACC,WAAR,CAAoBI,UAApB,CAAiC,CAA3C,CAV8C,GAY1C2H,CAAAA,CAAc,CAAGT,CAAM,CAAGH,CAZgB,CAa1Ca,CAAY,CAAGjI,OAAO,CAACC,WAAR,CAAoBM,wBAbO,CAe9CyH,CAAc,CAAGhI,OAAO,CAACkC,KAAR,CAAc4F,IAAd,CAAmBC,KAAnB,CACbE,CADa,CAEbD,CAFa,CAGbH,CAAQ,CAAGI,CAAX,CAA0BjI,OAAO,CAACC,WAAR,CAAoBI,UAHjC,CAAjB,CAKA,MAAO,CACLkH,MAAM,CAAES,CADH,CAELZ,IAAI,CAAEA,CAFD,CAIR,CAzBD,CA+BApH,OAAO,CAACC,WAAR,CAAoBiI,SAApB,CAAgC,UAAW,CACzC,MAAO,CAAC,CAAClI,OAAO,CAACC,WAAR,CAAoBE,MAC9B,CAFD,CAWAH,OAAO,CAACC,WAAR,CAAoBkI,WAApB,CAAkC,SAAS3C,CAAT,CAAgB4C,CAAhB,CAAsC,CACtE,GAAIpI,OAAO,CAACC,WAAR,CAAoBE,MAApB,GAA+BqF,CAAnC,CAA0C,CACxC,GAAI4C,CAAJ,CAA0B,CACxBpI,OAAO,CAACC,WAAR,CAAoBoI,oBAApB,EACD,CAFD,IAEO,CACLrI,OAAO,CAACC,WAAR,CAAoBqI,IAApB,EACD,CACD,QACD,CACD,QACD,CAVD,CAeAtI,OAAO,CAACC,WAAR,CAAoBqI,IAApB,CAA2B,UAAW,CAEpC,GAAIpH,CAAAA,CAAG,CAAGlB,OAAO,CAACC,WAAR,CAAoBgB,IAA9B,CAEAC,CAAG,CAACY,KAAJ,CAAUyG,SAAV,CAAsB,iBAAtB,CACArH,CAAG,CAACY,KAAJ,CAAUC,OAAV,CAAoB,CAApB,CAEA/B,OAAO,CAACC,WAAR,CAAoBS,gBAApB,CACI8H,UAAU,CAAC,UAAW,CACpBxI,OAAO,CAACC,WAAR,CAAoBoI,oBAApB,EACD,CAFS,CAE8B,GAArC,CAAArI,OAAO,CAACC,WAAR,CAAoBQ,cAFb,CADd,CAIA,GAAIT,OAAO,CAACC,WAAR,CAAoBU,OAAxB,CAAiC,CAC/BX,OAAO,CAACC,WAAR,CAAoBU,OAApB,GACAX,OAAO,CAACC,WAAR,CAAoBU,OAApB,CAA8B,IAC/B,CACF,CAfD,CAoBAX,OAAO,CAACC,WAAR,CAAoBoI,oBAApB,CAA2C,UAAW,CACpD,GAAI,CAACrI,OAAO,CAACC,WAAR,CAAoBiI,SAApB,EAAL,CAAsC,CACpC,MACD,CACD,GAAIlI,OAAO,CAACC,WAAR,CAAoBS,gBAAxB,CAA0C,CACxC+H,YAAY,CAACzI,OAAO,CAACC,WAAR,CAAoBS,gBAArB,CACb,CAID,GAAIQ,CAAAA,CAAG,CAAGlB,OAAO,CAACC,WAAR,CAAoBgB,IAA9B,CACAC,CAAG,CAACY,KAAJ,CAAUyG,SAAV,CAAsB,EAAtB,CACArH,CAAG,CAACY,KAAJ,CAAU6C,IAAV,CAAiB,EAAjB,CACAzD,CAAG,CAACY,KAAJ,CAAU2C,GAAV,CAAgB,EAAhB,CACAvD,CAAG,CAACY,KAAJ,CAAUC,OAAV,CAAoB,CAApB,CACAb,CAAG,CAACY,KAAJ,CAAU4G,OAAV,CAAoB,MAApB,CACAxH,CAAG,CAACY,KAAJ,CAAUiB,eAAV,CAA4B,EAA5B,CACA7B,CAAG,CAACY,KAAJ,CAAUkB,WAAV,CAAwB,EAAxB,CAEA,GAAIhD,OAAO,CAACC,WAAR,CAAoBU,OAAxB,CAAiC,CAC/BX,OAAO,CAACC,WAAR,CAAoBU,OAApB,GACAX,OAAO,CAACC,WAAR,CAAoBU,OAApB,CAA8B,IAC/B,CACDX,OAAO,CAACC,WAAR,CAAoBwC,YAApB,GACAzC,OAAO,CAACC,WAAR,CAAoBE,MAApB,CAA6B,IAA7B,CAEA,GAAIH,OAAO,CAACC,WAAR,CAAoBW,kBAAxB,CAA4C,CAC1CZ,OAAO,CAACkC,KAAR,CAAcC,GAAd,CAAkBE,WAAlB,CAA8BnB,CAA9B,CAAmClB,OAAO,CAACC,WAAR,CAAoBW,kBAAvD,EACAZ,OAAO,CAACC,WAAR,CAAoBW,kBAApB,CAAyC,EAC1C,CACD,GAAIZ,OAAO,CAACC,WAAR,CAAoBY,eAAxB,CAAyC,CACvCb,OAAO,CAACkC,KAAR,CAAcC,GAAd,CAAkBE,WAAlB,CAA8BnB,CAA9B,CAAmClB,OAAO,CAACC,WAAR,CAAoBY,eAAvD,EACAb,OAAO,CAACC,WAAR,CAAoBY,eAApB,CAAsC,EACvC,CAECb,OAAO,CAAC6F,gBAAR,EADF,CAC+B8C,WAD/B,EAED,CApCD,CAiDA3I,OAAO,CAACC,WAAR,CAAoBgG,iBAApB,CAAwC,SACpCpB,CADoC,CAC1BC,CAD0B,CAChBY,CADgB,CACJX,CADI,CACQ,CAC9C,GAAI6D,CAAAA,CAAO,CAAG5I,OAAO,CAACC,WAAR,CAAoBqG,mBAApB,CAAwCzB,CAAxC,CAAkDC,CAAlD,CACVY,CADU,CACEX,CADF,CAAd,CAIA,GAAI6D,CAAO,CAACnB,YAAZ,CAA0B,CACxBzH,OAAO,CAACC,WAAR,CAAoB4B,MAApB,CAA2BC,KAA3B,CAAiC4G,OAAjC,CAA2C,EAA3C,CACA1I,OAAO,CAACC,WAAR,CAAoB4B,MAApB,CAA2BC,KAA3B,CAAiCyG,SAAjC,CAA6C,aACzCK,CAAO,CAACrB,MADiC,CACxB,KADwB,CAChBqB,CAAO,CAAC3B,MADQ,CACC,mBAD9C,CAEAjH,OAAO,CAACC,WAAR,CAAoB4B,MAApB,CAA2BgH,YAA3B,CAAwC,OAAxC,CAAiDD,CAAO,CAACpB,UAAR,CAC7C,sCAD6C,CAE7C,yCAFJ,CAGD,CAPD,IAOO,CACLxH,OAAO,CAACC,WAAR,CAAoB4B,MAApB,CAA2BC,KAA3B,CAAiC4G,OAAjC,CAA2C,MAC5C,CAd6C,GAgB1CvB,CAAAA,CAAQ,CAAG2B,IAAI,CAACC,KAAL,CAAWH,CAAO,CAACzB,QAAnB,CAhB+B,CAiB1CE,CAAQ,CAAGyB,IAAI,CAACC,KAAL,CAAWH,CAAO,CAACvB,QAAnB,CAjB+B,CAkB1CC,CAAM,CAAGwB,IAAI,CAACC,KAAL,CAAWH,CAAO,CAACtB,MAAnB,CAlBiC,CAmB1CJ,CAAM,CAAG4B,IAAI,CAACC,KAAL,CAAWH,CAAO,CAAC1B,MAAnB,CAnBiC,CAqB1ChG,CAAG,CAAGlB,OAAO,CAACC,WAAR,CAAoBgB,IArBgB,CAuB9CC,CAAG,CAACY,KAAJ,CAAU6C,IAAV,CAAiBwC,CAAQ,CAAG,IAA5B,CACAjG,CAAG,CAACY,KAAJ,CAAU2C,GAAV,CAAgB4C,CAAQ,CAAG,IAA3B,CAGAnG,CAAG,CAACY,KAAJ,CAAU4G,OAAV,CAAoB,OAApB,CACAxH,CAAG,CAACY,KAAJ,CAAUC,OAAV,CAAoB,CAApB,CAMAb,CAAG,CAACY,KAAJ,CAAUyG,SAAV,CAAsB,cAFbjB,CAAM,CAAGH,CAEI,EAAoB,KAApB,EADbD,CAAM,CAAGG,CACI,EAAiC,KAAvD,CAEA,MAAO,CAAC,CAACuB,CAAO,CAACpB,UAClB,CAtCD,CA6CAxH,OAAO,CAACC,WAAR,CAAoB+I,yBAApB,CAAgD,UAAW,CAMzD,GAAIhJ,OAAO,CAACC,WAAR,CAAoBE,MAAxB,CAAgC,IAC1B+C,CAAAA,CAAK,CAAkClD,OAAO,CAACC,WAAR,CAAoBE,MADjC,CAE1BgD,CAAK,CAAqCD,CAAK,CAAC+B,cAAN,EAFhB,CAG1BrB,CAAI,CAAG5D,OAAO,CAACC,WAAR,CAAoBG,gBAApB,CACPJ,OAAO,CAACC,WAAR,CAAoBwD,qBAApB,CAA0CP,CAA1C,CADO,CAEPlD,OAAO,CAACC,WAAR,CAAoBsD,qBAApB,CAA0CJ,CAA1C,CAL0B,CAO1B0B,CAAQ,CAAGjB,CAAI,CAACe,IAAL,CAAY,CAACf,CAAI,CAACgB,KAAL,CAAahB,CAAI,CAACe,IAAnB,EAA2B,CAPxB,CAQ1BG,CAAQ,CAAGlB,CAAI,CAACc,MARU,CAW1BK,CAAU,CAAGnB,CAAI,CAACa,GAXQ,CAY9BzE,OAAO,CAACC,WAAR,CAAoBgG,iBAApB,CACIpB,CADJ,CACcC,CADd,CAFiBD,CAEjB,CACoCE,CADpC,CAED,CAdD,IAcO,CACL/E,OAAO,CAACC,WAAR,CAAoBqI,IAApB,EACD,CACF,CAvBD","sourcesContent":["/**\n * @license\n * Copyright 2016 Massachusetts Institute of Technology\n * All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview A div that floats on top of the workspace, for drop-down menus.\n * The drop-down can be kept inside the workspace, animate in/out, etc.\n * @author tmickel@mit.edu (Tim Mickel)\n */\n\n'use strict';\n\ngoog.provide('Blockly.DropDownDiv');\n\ngoog.require('Blockly.utils.dom');\ngoog.require('Blockly.utils.math');\ngoog.require('Blockly.utils.style');\n\ngoog.requireType('Blockly.utils.Rect');\ngoog.requireType('Blockly.utils.Size');\n\n\n/**\n * Class for drop-down div.\n * @constructor\n * @package\n */\nBlockly.DropDownDiv = function() {\n};\n\n/**\n * Drop-downs will appear within the bounds of this element if possible.\n * Set in Blockly.DropDownDiv.setBoundsElement.\n * @type {Element}\n * @private\n */\nBlockly.DropDownDiv.boundsElement_ = null;\n\n/**\n * The object currently using the drop-down.\n * @type {Object}\n * @private\n */\nBlockly.DropDownDiv.owner_ = null;\n\n/**\n * Whether the dropdown was positioned to a field or the source block.\n * @type {?boolean}\n * @private\n */\nBlockly.DropDownDiv.positionToField_ = null;\n\n/**\n * Arrow size in px. Should match the value in CSS\n * (need to position pre-render).\n * @type {number}\n * @const\n */\nBlockly.DropDownDiv.ARROW_SIZE = 16;\n\n/**\n * Drop-down border size in px. Should match the value in CSS (need to position\n * the arrow).\n * @type {number}\n * @const\n */\nBlockly.DropDownDiv.BORDER_SIZE = 1;\n\n/**\n * Amount the arrow must be kept away from the edges of the main drop-down div,\n * in px.\n * @type {number}\n * @const\n */\nBlockly.DropDownDiv.ARROW_HORIZONTAL_PADDING = 12;\n\n/**\n * Amount drop-downs should be padded away from the source, in px.\n * @type {number}\n * @const\n */\nBlockly.DropDownDiv.PADDING_Y = 16;\n\n/**\n * Length of animations in seconds.\n * @type {number}\n * @const\n */\nBlockly.DropDownDiv.ANIMATION_TIME = 0.25;\n\n/**\n * Timer for animation out, to be cleared if we need to immediately hide\n * without disrupting new shows.\n * @type {?number}\n * @private\n */\nBlockly.DropDownDiv.animateOutTimer_ = null;\n\n/**\n * Callback for when the drop-down is hidden.\n * @type {?Function}\n * @private\n */\nBlockly.DropDownDiv.onHide_ = null;\n\n/**\n * A class name representing the current owner's workspace renderer.\n * @type {string}\n * @private\n */\nBlockly.DropDownDiv.rendererClassName_ = '';\n\n/**\n * A class name representing the current owner's workspace theme.\n * @type {string}\n * @private\n */\nBlockly.DropDownDiv.themeClassName_ = '';\n\n/**\n * Dropdown bounds info object used to encapsulate sizing information about a\n * bounding element (bounding box and width/height).\n * @typedef {{\n *        top:number,\n *        left:number,\n *        bottom:number,\n *        right:number,\n *        width:number,\n *        height:number\n * }}\n */\nBlockly.DropDownDiv.BoundsInfo;\n\n/**\n * Dropdown position metrics.\n * @typedef {{\n *        initialX:number,\n *        initialY:number,\n *        finalX:number,\n *        finalY:number,\n *        arrowX:?number,\n *        arrowY:?number,\n *        arrowAtTop:?boolean,\n *        arrowVisible:boolean\n * }}\n */\nBlockly.DropDownDiv.PositionMetrics;\n \n/**\n * Create and insert the DOM element for this div.\n * @package\n */\nBlockly.DropDownDiv.createDom = function() {\n  if (Blockly.DropDownDiv.DIV_) {\n    return;  // Already created.\n  }\n  var div = document.createElement('div');\n  div.className = 'blocklyDropDownDiv';\n  var container = Blockly.parentContainer || document.body;\n  container.appendChild(div);\n  /**\n   * The div element.\n   * @type {!Element}\n   * @private\n   */\n  Blockly.DropDownDiv.DIV_ = div;\n\n  var content = document.createElement('div');\n  content.className = 'blocklyDropDownContent';\n  div.appendChild(content);\n  /**\n   * The content element.\n   * @type {!Element}\n   * @private\n   */\n  Blockly.DropDownDiv.content_ = content;\n\n  var arrow = document.createElement('div');\n  arrow.className = 'blocklyDropDownArrow';\n  div.appendChild(arrow);\n  /**\n   * The arrow element.\n   * @type {!Element}\n   * @private\n   */\n  Blockly.DropDownDiv.arrow_ = arrow;\n\n  Blockly.DropDownDiv.DIV_.style.opacity = 0;\n\n  // Transition animation for transform: translate() and opacity.\n  Blockly.DropDownDiv.DIV_.style.transition = 'transform ' +\n    Blockly.DropDownDiv.ANIMATION_TIME + 's, ' +\n    'opacity ' + Blockly.DropDownDiv.ANIMATION_TIME + 's';\n\n  // Handle focusin/out events to add a visual indicator when\n  // a child is focused or blurred.\n  div.addEventListener('focusin', function() {\n    Blockly.utils.dom.addClass(div, 'blocklyFocused');\n  });\n  div.addEventListener('focusout', function() {\n    Blockly.utils.dom.removeClass(div, 'blocklyFocused');\n  });\n};\n\n/**\n * Set an element to maintain bounds within. Drop-downs will appear\n * within the box of this element if possible.\n * @param {Element} boundsElement Element to bind drop-down to.\n */\nBlockly.DropDownDiv.setBoundsElement = function(boundsElement) {\n  Blockly.DropDownDiv.boundsElement_ = boundsElement;\n};\n\n/**\n * Provide the div for inserting content into the drop-down.\n * @return {!Element} Div to populate with content.\n */\nBlockly.DropDownDiv.getContentDiv = function() {\n  return Blockly.DropDownDiv.content_;\n};\n\n/**\n * Clear the content of the drop-down.\n */\nBlockly.DropDownDiv.clearContent = function() {\n  Blockly.DropDownDiv.content_.textContent = '';\n  Blockly.DropDownDiv.content_.style.width = '';\n};\n\n/**\n * Set the colour for the drop-down.\n * @param {string} backgroundColour Any CSS colour for the background.\n * @param {string} borderColour Any CSS colour for the border.\n */\nBlockly.DropDownDiv.setColour = function(backgroundColour, borderColour) {\n  Blockly.DropDownDiv.DIV_.style.backgroundColor = backgroundColour;\n  Blockly.DropDownDiv.DIV_.style.borderColor = borderColour;\n};\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular block. The primary position will be below the block,\n * and the secondary position above the block. Drop-down will be\n * constrained to the block's workspace.\n * @param {!Blockly.Field} field The field showing the drop-down.\n * @param {!Blockly.BlockSvg} block Block to position the drop-down around.\n * @param {Function=} opt_onHide Optional callback for when the drop-down is\n *   hidden.\n * @param {number=} opt_secondaryYOffset Optional Y offset for above-block\n *   positioning.\n * @return {boolean} True if the menu rendered below block; false if above.\n */\nBlockly.DropDownDiv.showPositionedByBlock = function(field, block,\n    opt_onHide, opt_secondaryYOffset) {\n  return Blockly.DropDownDiv.showPositionedByRect_(\n      Blockly.DropDownDiv.getScaledBboxOfBlock_(block),\n      field, opt_onHide, opt_secondaryYOffset);\n};\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular field. The primary position will be below the field,\n * and the secondary position above the field. Drop-down will be\n * constrained to the block's workspace.\n * @param {!Blockly.Field} field The field to position the dropdown against.\n * @param {Function=} opt_onHide Optional callback for when the drop-down is\n *   hidden.\n * @param {number=} opt_secondaryYOffset Optional Y offset for above-block\n *   positioning.\n * @return {boolean} True if the menu rendered below block; false if above.\n */\nBlockly.DropDownDiv.showPositionedByField = function(field,\n    opt_onHide, opt_secondaryYOffset) {\n  Blockly.DropDownDiv.positionToField_ = true;\n  return Blockly.DropDownDiv.showPositionedByRect_(\n      Blockly.DropDownDiv.getScaledBboxOfField_(field),\n      field, opt_onHide, opt_secondaryYOffset);\n};\n\n/**\n * Get the scaled bounding box of a block.\n * @param {!Blockly.BlockSvg} block The block.\n * @return {!Blockly.utils.Rect} The scaled bounding box of the block.\n * @private\n */\nBlockly.DropDownDiv.getScaledBboxOfBlock_ = function(block) {\n  var blockSvg = block.getSvgRoot();\n  var bBox = blockSvg.getBBox();\n  var scale = block.workspace.scale;\n  var scaledHeight = bBox.height * scale;\n  var scaledWidth = bBox.width * scale;\n  var xy = Blockly.utils.style.getPageOffset(blockSvg);\n  return new Blockly.utils.Rect(\n      xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n};\n\n/**\n * Get the scaled bounding box of a field.\n * @param {!Blockly.Field} field The field.\n * @return {!Blockly.utils.Rect} The scaled bounding box of the field.\n * @private\n */\nBlockly.DropDownDiv.getScaledBboxOfField_ = function(field) {\n  var bBox = field.getScaledBBox();\n  return new Blockly.utils.Rect(\n      bBox.top, bBox.bottom, bBox.left, bBox.right);\n};\n\n/**\n * Helper method to show and place the drop-down with positioning determined\n * by a scaled bounding box.  The primary position will be below the rect,\n * and the secondary position above the rect. Drop-down will be constrained to\n * the block's workspace.\n * @param {!Blockly.utils.Rect} bBox The scaled bounding box.\n * @param {!Blockly.Field} field The field to position the dropdown against.\n * @param {Function=} opt_onHide Optional callback for when the drop-down is\n *   hidden.\n * @param {number=} opt_secondaryYOffset Optional Y offset for above-block\n *   positioning.\n * @return {boolean} True if the menu rendered below block; false if above.\n * @private\n */\nBlockly.DropDownDiv.showPositionedByRect_ = function(bBox, field,\n    opt_onHide, opt_secondaryYOffset) {\n  // If we can fit it, render below the block.\n  var primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n  var primaryY = bBox.bottom;\n  // If we can't fit it, render above the entire parent block.\n  var secondaryX = primaryX;\n  var secondaryY = bBox.top;\n  if (opt_secondaryYOffset) {\n    secondaryY += opt_secondaryYOffset;\n  }\n  var sourceBlock = /** @type {!Blockly.BlockSvg} */ (field.getSourceBlock());\n  // Set bounds to main workspace; show the drop-down.\n  var workspace = sourceBlock.workspace;\n  while (workspace.options.parentWorkspace) {\n    workspace = /** @type {!Blockly.WorkspaceSvg} */ (\n      workspace.options.parentWorkspace);\n  }\n  Blockly.DropDownDiv.setBoundsElement(\n      /** @type {Element} */ (workspace.getParentSvg().parentNode));\n  return Blockly.DropDownDiv.show(\n      field, sourceBlock.RTL,\n      primaryX, primaryY, secondaryX, secondaryY, opt_onHide);\n};\n\n/**\n * Show and place the drop-down.\n * The drop-down is placed with an absolute \"origin point\" (x, y) - i.e.,\n * the arrow will point at this origin and box will positioned below or above\n * it.  If we can maintain the container bounds at the primary point, the arrow\n * will point there, and the container will be positioned below it.\n * If we can't maintain the container bounds at the primary point, fall-back to\n * the secondary point and position above.\n * @param {Object} owner The object showing the drop-down\n * @param {boolean} rtl Right-to-left (true) or left-to-right (false).\n * @param {number} primaryX Desired origin point x, in absolute px.\n * @param {number} primaryY Desired origin point y, in absolute px.\n * @param {number} secondaryX Secondary/alternative origin point x, in absolute\n *     px.\n * @param {number} secondaryY Secondary/alternative origin point y, in absolute\n *     px.\n * @param {Function=} opt_onHide Optional callback for when the drop-down is\n *     hidden.\n * @return {boolean} True if the menu rendered at the primary origin point.\n * @package\n */\nBlockly.DropDownDiv.show = function(owner, rtl, primaryX, primaryY,\n    secondaryX, secondaryY, opt_onHide) {\n  Blockly.DropDownDiv.owner_ = owner;\n  Blockly.DropDownDiv.onHide_ = opt_onHide || null;\n  // Set direction.\n  var div = Blockly.DropDownDiv.DIV_;\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n\n  var mainWorkspace =\n    /** @type {!Blockly.WorkspaceSvg} */ (Blockly.getMainWorkspace());\n  Blockly.DropDownDiv.rendererClassName_ =\n      mainWorkspace.getRenderer().getClassName();\n  Blockly.DropDownDiv.themeClassName_ = mainWorkspace.getTheme().getClassName();\n  Blockly.utils.dom.addClass(div, Blockly.DropDownDiv.rendererClassName_);\n  Blockly.utils.dom.addClass(div, Blockly.DropDownDiv.themeClassName_);\n\n  // When we change `translate` multiple times in close succession,\n  // Chrome may choose to wait and apply them all at once.\n  // Since we want the translation to initial X, Y to be immediate,\n  // and the translation to final X, Y to be animated,\n  // we saw problems where both would be applied after animation was turned on,\n  // making the dropdown appear to fly in from (0, 0).\n  // Using both `left`, `top` for the initial translation and then `translate`\n  // for the animated transition to final X, Y is a workaround.\n\n  return Blockly.DropDownDiv.positionInternal_(\n      primaryX, primaryY, secondaryX, secondaryY);\n};\n\n/**\n * Get sizing info about the bounding element.\n * @return {!Blockly.DropDownDiv.BoundsInfo} An object containing size\n *     information about the bounding element (bounding box and width/height).\n * @private\n */\nBlockly.DropDownDiv.getBoundsInfo_ = function() {\n  var boundPosition = Blockly.utils.style.getPageOffset(\n      /** @type {!Element} */ (Blockly.DropDownDiv.boundsElement_));\n  var boundSize = Blockly.utils.style.getSize(\n      /** @type {!Element} */ (Blockly.DropDownDiv.boundsElement_));\n\n  return {\n    left: boundPosition.x,\n    right: boundPosition.x + boundSize.width,\n    top: boundPosition.y,\n    bottom: boundPosition.y + boundSize.height,\n    width: boundSize.width,\n    height: boundSize.height\n  };\n};\n\n/**\n * Helper to position the drop-down and the arrow, maintaining bounds.\n * See explanation of origin points in Blockly.DropDownDiv.show.\n * @param {number} primaryX Desired origin point x, in absolute px.\n * @param {number} primaryY Desired origin point y, in absolute px.\n * @param {number} secondaryX Secondary/alternative origin point x,\n *     in absolute px.\n * @param {number} secondaryY Secondary/alternative origin point y,\n *     in absolute px.\n * @return {!Blockly.DropDownDiv.PositionMetrics} Various final metrics,\n *     including rendered positions for drop-down and arrow.\n * @private\n */\nBlockly.DropDownDiv.getPositionMetrics_ = function(primaryX, primaryY,\n    secondaryX, secondaryY) {\n  var boundsInfo = Blockly.DropDownDiv.getBoundsInfo_();\n  var divSize = Blockly.utils.style.getSize(\n      /** @type {!Element} */ (Blockly.DropDownDiv.DIV_));\n\n  // Can we fit in-bounds below the target?\n  if (primaryY + divSize.height < boundsInfo.bottom) {\n    return Blockly.DropDownDiv.getPositionBelowMetrics_(\n        primaryX, primaryY, boundsInfo, divSize);\n  }\n  // Can we fit in-bounds above the target?\n  if (secondaryY - divSize.height > boundsInfo.top) {\n    return Blockly.DropDownDiv.getPositionAboveMetrics_(\n        secondaryX, secondaryY, boundsInfo, divSize);\n  }\n  // Can we fit outside the workspace bounds (but inside the window) below?\n  if (primaryY + divSize.height < document.documentElement.clientHeight) {\n    return Blockly.DropDownDiv.getPositionBelowMetrics_(\n        primaryX, primaryY, boundsInfo, divSize);\n  }\n  // Can we fit outside the workspace bounds (but inside the window) above?\n  if (secondaryY - divSize.height > document.documentElement.clientTop) {\n    return Blockly.DropDownDiv.getPositionAboveMetrics_(\n        secondaryX, secondaryY, boundsInfo, divSize);\n  }\n\n  // Last resort, render at top of page.\n  return Blockly.DropDownDiv.getPositionTopOfPageMetrics_(\n      primaryX, boundsInfo, divSize);\n};\n\n/**\n * Get the metrics for positioning the div below the source.\n * @param {number} primaryX Desired origin point x, in absolute px.\n * @param {number} primaryY Desired origin point y, in absolute px.\n * @param {!Blockly.DropDownDiv.BoundsInfo} boundsInfo An object containing size\n *     information about the bounding element (bounding box and width/height).\n * @param {!Blockly.utils.Size} divSize An object containing information about\n *     the size of the DropDownDiv (width & height).\n * @return {!Blockly.DropDownDiv.PositionMetrics} Various final metrics,\n *     including rendered positions for drop-down and arrow.\n * @private\n */\nBlockly.DropDownDiv.getPositionBelowMetrics_ = function(\n    primaryX, primaryY, boundsInfo, divSize) {\n\n  var xCoords = Blockly.DropDownDiv.getPositionX(\n      primaryX, boundsInfo.left, boundsInfo.right, divSize.width);\n\n  var arrowY = -(Blockly.DropDownDiv.ARROW_SIZE / 2 +\n      Blockly.DropDownDiv.BORDER_SIZE);\n  var finalY = primaryY + Blockly.DropDownDiv.PADDING_Y;\n\n  return {\n    initialX: xCoords.divX,\n    initialY : primaryY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY: finalY,\n    arrowX: xCoords.arrowX,\n    arrowY: arrowY,\n    arrowAtTop: true,\n    arrowVisible: true\n  };\n};\n\n/**\n * Get the metrics for positioning the div above the source.\n * @param {number} secondaryX Secondary/alternative origin point x,\n *     in absolute px.\n * @param {number} secondaryY Secondary/alternative origin point y,\n *     in absolute px.\n * @param {!Blockly.DropDownDiv.BoundsInfo} boundsInfo An object containing size\n *     information about the bounding element (bounding box and width/height).\n * @param {!Blockly.utils.Size} divSize An object containing information about\n *     the size of the DropDownDiv (width & height).\n * @return {!Blockly.DropDownDiv.PositionMetrics} Various final metrics,\n *     including rendered positions for drop-down and arrow.\n * @private\n */\nBlockly.DropDownDiv.getPositionAboveMetrics_ = function(\n    secondaryX, secondaryY, boundsInfo, divSize) {\n\n  var xCoords = Blockly.DropDownDiv.getPositionX(\n      secondaryX, boundsInfo.left, boundsInfo.right, divSize.width);\n\n  var arrowY = divSize.height - (Blockly.DropDownDiv.BORDER_SIZE * 2) -\n      (Blockly.DropDownDiv.ARROW_SIZE / 2);\n  var finalY = secondaryY - divSize.height - Blockly.DropDownDiv.PADDING_Y;\n  var initialY = secondaryY - divSize.height; // No padding on Y\n\n  return {\n    initialX: xCoords.divX,\n    initialY : initialY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY: finalY,\n    arrowX: xCoords.arrowX,\n    arrowY: arrowY,\n    arrowAtTop: false,\n    arrowVisible: true\n  };\n};\n\n/**\n * Get the metrics for positioning the div at the top of the page.\n * @param {number} sourceX Desired origin point x, in absolute px.\n * @param {!Blockly.DropDownDiv.BoundsInfo} boundsInfo An object containing size\n *     information about the bounding element (bounding box and width/height).\n * @param {!Blockly.utils.Size} divSize An object containing information about\n *     the size of the DropDownDiv (width & height).\n * @return {!Blockly.DropDownDiv.PositionMetrics} Various final metrics,\n *     including rendered positions for drop-down and arrow.\n * @private\n */\nBlockly.DropDownDiv.getPositionTopOfPageMetrics_ = function(\n    sourceX, boundsInfo, divSize) {\n\n  var xCoords = Blockly.DropDownDiv.getPositionX(\n      sourceX, boundsInfo.left, boundsInfo.right, divSize.width);\n\n  // No need to provide arrow-specific information because it won't be visible.\n  return {\n    initialX: xCoords.divX,\n    initialY : 0,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY: 0,            // Y position remains constant during animation.\n    arrowAtTop: null,\n    arrowX: null,\n    arrowY: null,\n    arrowVisible: false\n  };\n};\n\n/**\n * Get the x positions for the left side of the DropDownDiv and the arrow,\n * accounting for the bounds of the workspace.\n * @param {number} sourceX Desired origin point x, in absolute px.\n * @param {number} boundsLeft The left edge of the bounding element, in\n *    absolute px.\n * @param {number} boundsRight The right edge of the bounding element, in\n *    absolute px.\n * @param {number} divWidth The width of the div in px.\n * @return {{divX: number, arrowX: number}} An object containing metrics for\n *    the x positions of the left side of the DropDownDiv and the arrow.\n * @package\n */\nBlockly.DropDownDiv.getPositionX = function(\n    sourceX, boundsLeft, boundsRight, divWidth) {\n  var arrowX, divX;\n  arrowX = divX = sourceX;\n\n  // Offset the topLeft coord so that the dropdowndiv is centered.\n  divX -= divWidth / 2;\n  // Fit the dropdowndiv within the bounds of the workspace.\n  divX = Blockly.utils.math.clamp(boundsLeft, divX, boundsRight - divWidth);\n\n  // Offset the arrow coord so that the arrow is centered.\n  arrowX -= Blockly.DropDownDiv.ARROW_SIZE / 2;\n  // Convert the arrow position to be relative to the top left of the div.\n  var relativeArrowX = arrowX - divX;\n  var horizPadding = Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING;\n  // Clamp the arrow position so that it stays attached to the dropdowndiv.\n  relativeArrowX = Blockly.utils.math.clamp(\n      horizPadding,\n      relativeArrowX,\n      divWidth - horizPadding - Blockly.DropDownDiv.ARROW_SIZE);\n\n  return {\n    arrowX: relativeArrowX,\n    divX: divX\n  };\n};\n\n/**\n * Is the container visible?\n * @return {boolean} True if visible.\n */\nBlockly.DropDownDiv.isVisible = function() {\n  return !!Blockly.DropDownDiv.owner_;\n};\n\n/**\n * Hide the menu only if it is owned by the provided object.\n * @param {Object} owner Object which must be owning the drop-down to hide.\n * @param {boolean=} opt_withoutAnimation True if we should hide the dropdown\n *     without animating.\n * @return {boolean} True if hidden.\n */\nBlockly.DropDownDiv.hideIfOwner = function(owner, opt_withoutAnimation) {\n  if (Blockly.DropDownDiv.owner_ === owner) {\n    if (opt_withoutAnimation) {\n      Blockly.DropDownDiv.hideWithoutAnimation();\n    } else {\n      Blockly.DropDownDiv.hide();\n    }\n    return true;\n  }\n  return false;\n};\n\n/**\n * Hide the menu, triggering animation.\n */\nBlockly.DropDownDiv.hide = function() {\n  // Start the animation by setting the translation and fading out.\n  var div = Blockly.DropDownDiv.DIV_;\n  // Reset to (initialX, initialY) - i.e., no translation.\n  div.style.transform = 'translate(0, 0)';\n  div.style.opacity = 0;\n  // Finish animation - reset all values to default.\n  Blockly.DropDownDiv.animateOutTimer_ =\n      setTimeout(function() {\n        Blockly.DropDownDiv.hideWithoutAnimation();\n      }, Blockly.DropDownDiv.ANIMATION_TIME * 1000);\n  if (Blockly.DropDownDiv.onHide_) {\n    Blockly.DropDownDiv.onHide_();\n    Blockly.DropDownDiv.onHide_ = null;\n  }\n};\n\n/**\n * Hide the menu, without animation.\n */\nBlockly.DropDownDiv.hideWithoutAnimation = function() {\n  if (!Blockly.DropDownDiv.isVisible()) {\n    return;\n  }\n  if (Blockly.DropDownDiv.animateOutTimer_) {\n    clearTimeout(Blockly.DropDownDiv.animateOutTimer_);\n  }\n\n  // Reset style properties in case this gets called directly\n  // instead of hide() - see discussion on #2551.\n  var div = Blockly.DropDownDiv.DIV_;\n  div.style.transform = '';\n  div.style.left = '';\n  div.style.top = '';\n  div.style.opacity = 0;\n  div.style.display = 'none';\n  div.style.backgroundColor = '';\n  div.style.borderColor = '';\n\n  if (Blockly.DropDownDiv.onHide_) {\n    Blockly.DropDownDiv.onHide_();\n    Blockly.DropDownDiv.onHide_ = null;\n  }\n  Blockly.DropDownDiv.clearContent();\n  Blockly.DropDownDiv.owner_ = null;\n\n  if (Blockly.DropDownDiv.rendererClassName_) {\n    Blockly.utils.dom.removeClass(div, Blockly.DropDownDiv.rendererClassName_);\n    Blockly.DropDownDiv.rendererClassName_ = '';\n  }\n  if (Blockly.DropDownDiv.themeClassName_) {\n    Blockly.utils.dom.removeClass(div, Blockly.DropDownDiv.themeClassName_);\n    Blockly.DropDownDiv.themeClassName_ = '';\n  }\n  (/** @type {!Blockly.WorkspaceSvg} */ (\n    Blockly.getMainWorkspace())).markFocused();\n};\n\n/**\n * Set the dropdown div's position.\n * @param {number} primaryX Desired origin point x, in absolute px.\n * @param {number} primaryY Desired origin point y, in absolute px.\n * @param {number} secondaryX Secondary/alternative origin point x,\n *    in absolute px.\n * @param {number} secondaryY Secondary/alternative origin point y,\n *    in absolute px.\n * @return {boolean} True if the menu rendered at the primary origin point.\n * @private\n */\nBlockly.DropDownDiv.positionInternal_ = function(\n    primaryX, primaryY, secondaryX, secondaryY) {\n  var metrics = Blockly.DropDownDiv.getPositionMetrics_(primaryX, primaryY,\n      secondaryX, secondaryY);\n\n  // Update arrow CSS.\n  if (metrics.arrowVisible) {\n    Blockly.DropDownDiv.arrow_.style.display = '';\n    Blockly.DropDownDiv.arrow_.style.transform = 'translate(' +\n        metrics.arrowX + 'px,' + metrics.arrowY + 'px) rotate(45deg)';\n    Blockly.DropDownDiv.arrow_.setAttribute('class', metrics.arrowAtTop ?\n        'blocklyDropDownArrow blocklyArrowTop' :\n        'blocklyDropDownArrow blocklyArrowBottom');\n  } else {\n    Blockly.DropDownDiv.arrow_.style.display = 'none';\n  }\n\n  var initialX = Math.floor(metrics.initialX);\n  var initialY = Math.floor(metrics.initialY);\n  var finalX = Math.floor(metrics.finalX);\n  var finalY = Math.floor(metrics.finalY);\n\n  var div = Blockly.DropDownDiv.DIV_;\n  // First apply initial translation.\n  div.style.left = initialX + 'px';\n  div.style.top = initialY + 'px';\n\n  // Show the div.\n  div.style.display = 'block';\n  div.style.opacity = 1;\n  // Add final translate, animated through `transition`.\n  // Coordinates are relative to (initialX, initialY),\n  // where the drop-down is absolutely positioned.\n  var dx = finalX - initialX;\n  var dy = finalY - initialY;\n  div.style.transform = 'translate(' + dx + 'px,' + dy + 'px)';\n\n  return !!metrics.arrowAtTop;\n};\n\n/**\n * Repositions the dropdownDiv on window resize. If it doesn't know how to\n * calculate the new position, it will just hide it instead.\n * @package\n */\nBlockly.DropDownDiv.repositionForWindowResize = function() {\n  // This condition mainly catches the dropdown div when it is being used as a\n  // dropdown.  It is important not to close it in this case because on Android,\n  // when a field is focused, the soft keyboard opens triggering a window resize\n  // event and we want the dropdown div to stick around so users can type into\n  // it.\n  if (Blockly.DropDownDiv.owner_) {\n    var field = /** @type {!Blockly.Field} */ (Blockly.DropDownDiv.owner_);\n    var block = /** @type {!Blockly.BlockSvg} */ (field.getSourceBlock());\n    var bBox = Blockly.DropDownDiv.positionToField_ ?\n        Blockly.DropDownDiv.getScaledBboxOfField_(field) :\n        Blockly.DropDownDiv.getScaledBboxOfBlock_(block);\n    // If we can fit it, render below the block.\n    var primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n    var primaryY = bBox.bottom;\n    // If we can't fit it, render above the entire parent block.\n    var secondaryX = primaryX;\n    var secondaryY = bBox.top;\n    Blockly.DropDownDiv.positionInternal_(\n        primaryX, primaryY, secondaryX, secondaryY);\n  } else {\n    Blockly.DropDownDiv.hide();\n  }\n};\n"],"file":"dropdowndiv.min.js"}