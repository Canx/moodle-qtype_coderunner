'use strict';goog.provide("Blockly.geras");goog.provide("Blockly.geras.RenderInfo");goog.require("Blockly.blockRendering.BottomRow");goog.require("Blockly.blockRendering.InputRow");goog.require("Blockly.blockRendering.Measurable");goog.require("Blockly.blockRendering.NextConnection");goog.require("Blockly.blockRendering.OutputConnection");goog.require("Blockly.blockRendering.PreviousConnection");goog.require("Blockly.blockRendering.RenderInfo");goog.require("Blockly.blockRendering.BottomRow");goog.require("Blockly.blockRendering.InputRow");goog.require("Blockly.blockRendering.Measurable");goog.require("Blockly.blockRendering.NextConnection");goog.require("Blockly.blockRendering.OutputConnection");goog.require("Blockly.blockRendering.PreviousConnection");goog.require("Blockly.blockRendering.Types");goog.require("Blockly.blockRendering.ExternalValueInput");goog.require("Blockly.geras.InlineInput");goog.require("Blockly.geras.StatementInput");goog.require("Blockly.utils.object");Blockly.geras.RenderInfo=function(a,b){Blockly.geras.RenderInfo.superClass_.constructor.call(this,a,b)};Blockly.utils.object.inherits(Blockly.geras.RenderInfo,Blockly.blockRendering.RenderInfo);Blockly.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_};Blockly.geras.RenderInfo.prototype.populateBottomRow_=function(){Blockly.geras.RenderInfo.superClass_.populateBottomRow_.call(this);var a=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==Blockly.NEXT_STATEMENT;if(!a){this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET}};Blockly.geras.RenderInfo.prototype.addInput_=function(a,b){if(this.isInline&&a.type==Blockly.INPUT_VALUE){b.elements.push(new Blockly.geras.InlineInput(this.constants_,a));b.hasInlineInput=!0}else if(a.type==Blockly.NEXT_STATEMENT){b.elements.push(new Blockly.geras.StatementInput(this.constants_,a));b.hasStatement=!0}else if(a.type==Blockly.INPUT_VALUE){b.elements.push(new Blockly.blockRendering.ExternalValueInput(this.constants_,a));b.hasExternalInput=!0}else if(a.type==Blockly.DUMMY_INPUT){b.minHeight=Math.max(b.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT);b.hasDummyInput=!0}if(!this.isInline&&null==b.align){b.align=a.align}};Blockly.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var a=!1,b=0,c;c=this.rows[b];b++){if(c.hasExternalInput){a=!0}}for(var b=0,c,d;c=this.rows[b];b++){d=c.elements;c.elements=[];if(c.startsWithElemSpacer()){c.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,d[0])))}if(!d.length){continue}for(var f=0;f<d.length-1;f++){c.elements.push(d[f]);var g=this.getInRowSpacing_(d[f],d[f+1]);c.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,g))}c.elements.push(d[d.length-1]);if(c.endsWithElemSpacer()){var g=this.getInRowSpacing_(d[d.length-1],null);if(a&&c.hasDummyInput){g+=this.constants_.TAB_WIDTH}c.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,g))}}};Blockly.geras.RenderInfo.prototype.getInRowSpacing_=function(a,b){if(!a){if(b&&Blockly.blockRendering.Types.isField(b)&&b.isEditable){return this.constants_.MEDIUM_PADDING}if(b&&Blockly.blockRendering.Types.isInlineInput(b)){return this.constants_.MEDIUM_LARGE_PADDING}if(b&&Blockly.blockRendering.Types.isStatementInput(b)){return this.constants_.STATEMENT_INPUT_PADDING_LEFT}return this.constants_.LARGE_PADDING}if(!Blockly.blockRendering.Types.isInput(a)&&(!b||Blockly.blockRendering.Types.isStatementInput(b))){if(Blockly.blockRendering.Types.isField(a)&&a.isEditable){return this.constants_.MEDIUM_PADDING}if(Blockly.blockRendering.Types.isIcon(a)){return 2*this.constants_.LARGE_PADDING+1}if(Blockly.blockRendering.Types.isHat(a)){return this.constants_.NO_PADDING}if(Blockly.blockRendering.Types.isPreviousOrNextConnection(a)){return this.constants_.LARGE_PADDING}if(Blockly.blockRendering.Types.isLeftRoundedCorner(a)){return this.constants_.MIN_BLOCK_WIDTH}if(Blockly.blockRendering.Types.isJaggedEdge(a)){return this.constants_.NO_PADDING}return this.constants_.LARGE_PADDING}if(Blockly.blockRendering.Types.isInput(a)&&!b){if(Blockly.blockRendering.Types.isExternalInput(a)){return this.constants_.NO_PADDING}else if(Blockly.blockRendering.Types.isInlineInput(a)){return this.constants_.LARGE_PADDING}else if(Blockly.blockRendering.Types.isStatementInput(a)){return this.constants_.NO_PADDING}}if(!Blockly.blockRendering.Types.isInput(a)&&b&&Blockly.blockRendering.Types.isInput(b)){if(Blockly.blockRendering.Types.isField(a)&&a.isEditable){if(Blockly.blockRendering.Types.isInlineInput(b)){return this.constants_.SMALL_PADDING}else if(Blockly.blockRendering.Types.isExternalInput(b)){return this.constants_.SMALL_PADDING}}else{if(Blockly.blockRendering.Types.isInlineInput(b)){return this.constants_.MEDIUM_LARGE_PADDING}else if(Blockly.blockRendering.Types.isExternalInput(b)){return this.constants_.MEDIUM_LARGE_PADDING}else if(Blockly.blockRendering.Types.isStatementInput(b)){return this.constants_.LARGE_PADDING}}return this.constants_.LARGE_PADDING-1}if(Blockly.blockRendering.Types.isIcon(a)&&b&&!Blockly.blockRendering.Types.isInput(b)){return this.constants_.LARGE_PADDING}if(Blockly.blockRendering.Types.isInlineInput(a)&&b&&Blockly.blockRendering.Types.isField(b)){if(b.isEditable){return this.constants_.MEDIUM_PADDING}else{return this.constants_.LARGE_PADDING}}if(Blockly.blockRendering.Types.isLeftSquareCorner(a)&&b){if(Blockly.blockRendering.Types.isHat(b)){return this.constants_.NO_PADDING}if(Blockly.blockRendering.Types.isPreviousConnection(b)){return b.notchOffset}else if(Blockly.blockRendering.Types.isNextConnection(b)){var c=(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2;return b.notchOffset+c}}if(Blockly.blockRendering.Types.isLeftRoundedCorner(a)&&b){if(Blockly.blockRendering.Types.isPreviousConnection(b)){return b.notchOffset-this.constants_.CORNER_RADIUS}else if(Blockly.blockRendering.Types.isNextConnection(b)){var c=(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2;return b.notchOffset-this.constants_.CORNER_RADIUS+c}}if(Blockly.blockRendering.Types.isField(a)&&b&&Blockly.blockRendering.Types.isField(b)&&a.isEditable==b.isEditable){return this.constants_.LARGE_PADDING}if(b&&Blockly.blockRendering.Types.isJaggedEdge(b)){return this.constants_.LARGE_PADDING}return this.constants_.MEDIUM_PADDING};Blockly.geras.RenderInfo.prototype.getSpacerRowHeight_=function(a,b){if(Blockly.blockRendering.Types.isTopRow(a)&&Blockly.blockRendering.Types.isBottomRow(b)){return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT}if(Blockly.blockRendering.Types.isTopRow(a)||Blockly.blockRendering.Types.isBottomRow(b)){return this.constants_.NO_PADDING}if(a.hasExternalInput&&b.hasExternalInput){return this.constants_.LARGE_PADDING}if(!a.hasStatement&&b.hasStatement){return this.constants_.BETWEEN_STATEMENT_PADDING_Y}if(a.hasStatement&&b.hasStatement){return this.constants_.LARGE_PADDING}if(!a.hasStatement&&b.hasDummyInput){return this.constants_.LARGE_PADDING}if(a.hasDummyInput){return this.constants_.LARGE_PADDING}return this.constants_.MEDIUM_PADDING};Blockly.geras.RenderInfo.prototype.getElemCenterline_=function(a,b){if(Blockly.blockRendering.Types.isSpacer(b)){return a.yPos+b.height/2}if(Blockly.blockRendering.Types.isBottomRow(a)){var c=a.yPos+a.height-a.descenderHeight;if(Blockly.blockRendering.Types.isNextConnection(b)){return c+b.height/2}return c-b.height/2}if(Blockly.blockRendering.Types.isTopRow(a)){if(Blockly.blockRendering.Types.isHat(b)){return a.capline-b.height/2}return a.capline+b.height/2}var d=a.yPos;if(Blockly.blockRendering.Types.isField(b)||Blockly.blockRendering.Types.isIcon(b)){d+=b.height/2;if((a.hasInlineInput||a.hasStatement)&&b.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=a.height){d+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y}}else if(Blockly.blockRendering.Types.isInlineInput(b)){d+=b.height/2}else{d+=a.height/2}return d};Blockly.geras.RenderInfo.prototype.alignRowElements_=function(){if(!this.isInline){Blockly.geras.RenderInfo.superClass_.alignRowElements_.call(this);return}for(var a=0,b=null,c=this.rows.length-1,d;d=this.rows[c];c--){d.nextRightEdge=a;if(Blockly.blockRendering.Types.isInputRow(d)){if(d.hasStatement){this.alignStatementRow_(d)}if(b&&b.hasStatement&&d.width<b.width){d.nextRightEdge=b.width}else{a=d.width}b=d}}for(var e=0,c=0,d;d=this.rows[c];c++){if(d.hasStatement){e=this.getDesiredRowWidth_(d)}else if(Blockly.blockRendering.Types.isSpacer(d)){d.width=Math.max(e,d.nextRightEdge)}else{var f=d.width,g=Math.max(e,d.nextRightEdge),h=g-f;if(0<h){this.addAlignmentPadding_(d,h)}e=d.width}}};Blockly.geras.RenderInfo.prototype.getDesiredRowWidth_=function(a){if(this.isInline&&a.hasStatement){return this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX}return Blockly.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,a)};Blockly.geras.RenderInfo.prototype.finalize_=function(){for(var a=0,b=0,c=0,d;d=this.rows[c];c++){d.yPos=b;d.xPos=this.startX;b+=d.height;a=Math.max(a,d.widthWithConnectedBlocks);var e=b-this.topRow.ascenderHeight;if(d==this.bottomRow&&e<this.constants_.MIN_BLOCK_HEIGHT){var f=this.constants_.MIN_BLOCK_HEIGHT-e;this.bottomRow.height+=f;b+=f}this.recordElemPositions_(d)}if(this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()){a=Math.max(a,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)}this.bottomRow.baseline=b-this.bottomRow.descenderHeight;this.widthWithChildren=a+this.startX+this.constants_.DARK_PATH_OFFSET;this.width+=this.constants_.DARK_PATH_OFFSET;this.height=b+this.constants_.DARK_PATH_OFFSET;this.startY=this.topRow.capline};
//# sourceMappingURL=info.min.js.map
