{"version":3,"sources":["../../src/node-blockly/gulpfile.js"],"names":["gulp","require","replace","rename","insert","beautifier","skippable","condition","fn","skipped","cb","displayName","name","_browserRename","path","basename","document","blockly","src","pipe","wrap","dest","blockly_browser","blocks","blocks_browser","js","dart","python","php","lua","i18n","beautify","indent_size","exports","build","series","process","env","DEBUG"],"mappings":"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","sourcesContent":["'use strict';\n\nvar gulp = require('gulp'),\n  replace = require('gulp-replace'),\n  rename = require(\"gulp-rename\"),\n  insert = require('gulp-insert'),\n  beautifier = require('gulp-beautify');\n\nfunction skippable(condition, fn){\n  if (condition) {\n    return fn;\n  }\n\n  function skipped(cb){\n    cb();\n  }\n  skipped.displayName = (fn.name || fn.displayName) + ' (skipped)';\n  return skipped;\n}\n\nvar _browserRename = function (path) {\n  path.basename += \"_browser\";\n};\n\nvar document = `var JSDOM = require('jsdom').JSDOM;\n var window = (new JSDOM()).window;\n var document = window.document;\n var Element = window.Element; \n var Node = window.Node; \n var self = this; \n`;\n\nfunction blockly() {\n  return gulp.src('blockly/blockly_compressed.js')\n    .pipe(replace(\n      \"this.navigator&&this.navigator.userAgent||\",\n      ''))\n    .pipe(insert.wrap(`\n      ${document}\n      var xmlshim = require('xmlshim');\n      var XMLSerializer = xmlshim.XMLSerializer;\n      var DOMParser = xmlshim.DOMParser; \n      module.exports = (function(){ // `,\n      //....ORIGINAL CODE....\n      `return Blockly;\n      })()`))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction blockly_browser() {\n  return gulp.src('blockly/blockly_compressed.js')\n    .pipe(replace(\n      \"this.navigator&&this.navigator.userAgent||\",\n      'window.navigator&&window.navigator.userAgent||'))\n    .pipe(insert.wrap(`\n      /* eslint-disable */\n      module.exports = (function(){ //`,\n      //....ORIGINAL CODE....\n      `return Blockly;\n      })()`))\n    .pipe(rename(_browserRename))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction blocks() {\n  return gulp.src('blockly/blocks_compressed.js')\n    .pipe(insert.wrap(`\n        module.exports = function(Blockly){\n          var goog = Blockly.goog;        \n          ${document}\n          Blockly.Blocks={};`,\n      //....ORIGINAL CODE....\n      `return Blockly.Blocks;\n        }`))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction blocks_browser() {\n  return gulp.src('blockly/blocks_compressed.js')\n    .pipe(insert.wrap(`\n        /* eslint-disable */\n        module.exports = function(Blockly){\n          Blockly.Blocks={};`,\n      //....ORIGINAL CODE....\n      `return Blockly.Blocks;\n        }`))\n    .pipe(rename(_browserRename))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction js() {\n  return gulp.src('blockly/javascript_compressed.js')\n    .pipe(insert.wrap('module.exports = function(Blockly){', 'return Blockly.JavaScript;}'))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction dart() {\n  return gulp.src('blockly/dart_compressed.js')\n    .pipe(insert.wrap('module.exports = function(Blockly){', 'return Blockly.Dart;}'))\n    .pipe(replace(/window\\./g, ''))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction python() {\n  return gulp.src('blockly/python_compressed.js')\n    .pipe(insert.wrap('module.exports = function(Blockly){', 'return Blockly.Python;}'))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction php() {\n  return gulp.src('blockly/php_compressed.js')\n    .pipe(insert.wrap('module.exports = function(Blockly){', 'return Blockly.PHP;}'))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction lua() {\n  return gulp.src('blockly/lua_compressed.js')\n    .pipe(insert.wrap('module.exports = function(Blockly){', 'return Blockly.Lua;}'))\n    .pipe(gulp.dest('lib'))\n}\n\nfunction i18n() {\n  return gulp.src('blockly/msg/js/*.js')\n    .pipe(replace(/goog\\.[^\\n]+/g, ''))\n    .pipe(insert.wrap('var Blockly = {}; Blockly.Msg={};  module.exports = function(){ ', 'return Blockly.Msg;}'))\n    .pipe(gulp.dest('lib/i18n/'))\n}\n\nfunction beautify() {\n  return gulp.src('lib/*.js')\n    .pipe(beautifier.js({indent_size: 2}))\n    .pipe(gulp.dest('lib/'));\n};\n\nexports.build = gulp.series(\n  blocks,\n  blocks_browser,\n  blockly,\n  blockly_browser,\n  i18n,\n  js,\n  php,\n  dart,\n  python,\n  lua,\n  skippable(process.env.DEBUG, beautify),\n);\n\n\n\n\n\n"],"file":"gulpfile.min.js"}